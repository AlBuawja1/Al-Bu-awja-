<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†Ø¸ÙˆÙ…Ø© Ø¹ÙŠØª Ø¨ÙˆØ¹ÙˆØ¬Ù‡ - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø®ØªØ§Ù…ÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --main-blue: #1e3799; --accent-blue: #0097e6; --bg-color: #f1f2f6; --success: #2ecc71; --danger: #e74c3c; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg-color); margin: 0; padding: 10px; }
        .container { background: white; max-width: 600px; margin: auto; padding: 20px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { color: var(--main-blue); text-align: center; margin-bottom: 20px; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; text-align: center; }
        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 12px; border: 1px solid #eee; }
        .stat-card b { display: block; font-size: 20px; color: var(--main-blue); margin-top: 5px; }
        
        /* Ù‚Ø³Ù… Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø§Ù„Ù…Ø­Ø¯Ø« */
        .highlight-box { grid-column: span 2; background: #ffeaa7; border: 1px solid #fdcb6e; padding: 15px; border-radius: 12px; text-align: center; margin-top: 5px; }
        .highlight-box b { font-size: 22px; color: var(--danger); display: block; margin: 5px 0; }
        .highlight-box .date-text { font-size: 13px; color: #7f8c8d; font-weight: bold; border-top: 1px solid #e67e2244; padding-top: 5px; margin-top: 5px; display: block; }

        input { width: 100%; padding: 14px; border: 2px solid #ddd; border-radius: 12px; text-align: center; box-sizing: border-box; font-size: 16px; margin-bottom: 10px; }
        .btn { width: 100%; padding: 13px; border-radius: 12px; border: none; cursor: pointer; font-weight: bold; color: white; margin-bottom: 8px; font-size: 15px; }
        .btn-purple { background: #8e44ad; }
        .btn-blue { background: var(--main-blue); }
        .btn-cyan { background: #00a8ff; }
        .btn-grey { background: #7f8c8d; }
        .btn-excel { background: #1f7244; }

        #output { margin-top: 20px; max-height: 600px; overflow-y: auto; padding: 5px; }
        .member-card { background: white; border: 1px solid #eee; border-right: 6px solid var(--main-blue); padding: 15px; border-radius: 12px; margin-bottom: 15px; }
        .member-name { font-weight: bold; font-size: 17px; color: #2f3542; margin-bottom: 8px; }
        
        .service-btns { display: flex; gap: 8px; margin-top: 10px; }
        .service-btn { flex: 1; padding: 10px; border-radius: 8px; text-decoration: none; color: white; text-align: center; font-size: 13px; font-weight: bold; }
        .wa { background: #25d366; }
        .sms { background: #3498db; }

        .footer { text-align: center; margin-top: 30px; font-size: 14px; color: #777; border-top: 1px solid #eee; padding-top: 10px; }
        .dev-name { color: var(--accent-blue); font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>Ø¬Ù…Ø¹ÙŠØ© Ø¹ÙŠØª Ø¨ÙˆØ¹ÙˆØ¬Ù‡</h2>

    <div class="stats-grid" id="statsArea">
        <div class="stat-card">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡<b>86</b></div>
        <div class="stat-card">Ø§Ù„Ù…Ø³Ø¯Ø¯ÙŠÙ† 2025<b id="paidCount" style="color:var(--success)">0</b></div>
        <div class="stat-card">ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¯Ø¯ÙŠÙ†<b id="unpaidCount" style="color:var(--danger)">0</b></div>
        
        <div class="highlight-box">
            Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ø¹Ø§Ù… 2025
            <b id="totalDebtDisplay">0 Ø¯.Ù„</b>
            <span class="date-text" id="currentDateDisplay">ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…: </span>
        </div>
        
        <div class="stat-card" style="grid-column: span 2;">Ø±ØµÙŠØ¯ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ<b id="totalBalanceDisplay" style="color:var(--main-blue)">0 Ø¯.Ù„</b></div>
    </div>

    <button class="btn btn-purple" onclick="copyFullReport()">ğŸ“‹ Ù†Ø³Ø® ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©</button>
    <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ...">
    <button class="btn btn-blue" onclick="handleSearch()">ğŸ” Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹</button>
    
    <div style="display: flex; gap: 10px;">
        <button class="btn btn-grey" style="flex: 1;" onclick="toggleStats()">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</button>
        <button class="btn btn-cyan" style="flex: 1;" onclick="showAll()">ğŸ“‹ Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
    </div>
    
    <button class="btn btn-excel" onclick="exportToExcel()">ğŸ“¥ Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙƒØ´Ù Excel</button>
    <div id="output"></div>

    <div class="footer">
        ØªÙ…Øª Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø·ÙˆØ±:<br>
        <span class="dev-name">Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¹Ø·ÙŠØ©</span>
    </div>
</div>

<script>
const requiredAmount = 120; 

const members = [
    {n:"Ø¬Ù…Ø§Ù„ ØµØ§Ù„Ø­ Ø±Ø§ÙØ§Ù„Ù„Ù‡", p:"", v:240, note: "Ù…Ø³Ø¯Ø¯ Ù„Ø¹Ø§Ù… 2025 Ùˆ 2026 Ù…Ø³Ø¨Ù‚Ø§Ù‹"},
    {n:"Ù…Ù‡Ù†Ø¯ Ø§Ù„ØµØ§Ø¯Ù‚ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0913135438", v:120},
    {n:"Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¬Ù…Ø¹Ù‡ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"0910507974", v:120},
    {n:"Ø§Ø­Ù…Ø¯ Ø¬Ù…Ø¹Ù‡ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"0926392262", v:120},
    {n:"Ø§Ù„Ù…Ù†ØªØµØ± Ø§Ù„ØµØ§Ø¯Ù‚ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0910769070", v:120},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0922775978", v:120},
    {n:"Ø¹Ø·ÙŠÙ‡ Ø¬Ø¨Ø±ÙŠÙ„ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0928032942", v:120},
    {n:"Ø¨Ø´Ø§Ø± ØµÙ„Ø§Ø­ Ø¬Ø¨Ø±ÙŠÙ„", p:"0928182311", v:120},
    {n:"Ø¬Ø¨Ø±ÙŠÙ„ ØµÙ„Ø§Ø­ Ø¬Ø¨Ø±ÙŠÙ„", p:"0924022089", v:120},
    {n:"Ø¬Ø¨Ø±ÙŠÙ„ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"0945241695", v:120},
    {n:"Ø­ÙÙŠØ¸ Ø¬Ø¨Ø±ÙŠÙ„ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0924986577", v:120},
    {n:"Ø­Ù…ÙŠØ¯ Ø¬Ø¨Ø±ÙŠÙ„ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0922589497", v:120},
    {n:"Ø®Ø§Ù„Ø¯ Ø§Ù„ØµØ§Ø¯Ù‚ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0942839066", v:120},
    {n:"Ø®Ø§Ù„Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ø·ÙŠ Ø§Ù„Ù…Ù‚Ø·ÙˆØ´", p:"0927060787", v:120},
    {n:"Ø§ÙŠÙ…Ù† ØµØ§Ù„Ø­ Ø±Ø§ÙØ§Ù„Ù„Ù‡", p:"0910555947", v:120},
    {n:"Ù†Ø§ÙØ¹ ØµØ§Ù„Ø­ Ø±Ø§ÙØ§Ù„Ù„Ù‡", p:"0913846098", v:120},
    {n:"Ø®Ù„ÙŠÙ„ ØµÙ„Ø§Ø­ Ø¬Ø¨Ø±ÙŠÙ„", p:"0927579574", v:120},
    {n:"Ø²ÙƒØ±ÙŠØ§ Ø­ÙÙŠØ¸ Ø¬Ø¨Ø±ÙŠÙ„", p:"0931564525", v:120},
    {n:"Ø³Ø§Ù„Ù… Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0919283966", v:120},
    {n:"Ø§Ø­Ù…Ø¯ Ø¬Ø¨Ø±ÙŠÙ„ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0914947810", v:120},
    {n:"Ø³Ø§Ù„Ù… Ø¬Ø¨Ø±ÙŠÙ„ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0924173471", v:120},
    {n:"Ø¹Ø§Ø¯Ù„ Ø¬Ø¨Ø±ÙŠÙ„ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0927265392", v:120},
    {n:"Ø§Ù„ØµØ§Ø¯Ù‚ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¹Ø·ÙŠÙ‡", p:"0925488627", v:120},
    {n:"Ø·Ù‡ Ø¹Ø·ÙŠÙ‡ Ø¬Ø¨Ø±ÙŠÙ„", p:"0918329952", v:120},
    {n:"Ø¹Ø§Ù…Ø± ØµÙ„Ø§Ø­ Ø¬Ø¨Ø±ÙŠÙ„", p:"0922456410", v:120},
    {n:"Ø¹Ø·ÙŠÙ‡ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"0927412258", v:120},
    {n:"ÙØ±Ø¬ Ù…Ø­Ù…Ø¯ Ø¨ÙˆØ¹ÙˆØ¬Ù‡", p:"0920251087", v:120},
    {n:"Ù…Ø­Ù…Ø¯ Ø¹Ø·ÙŠÙ‡ Ø¬Ø¨Ø±ÙŠÙ„", p:"0923781053", v:120},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„ÙˆÙ‡Ø§Ø¨ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0923110838", v:120},
    {n:"Ø­ÙÙŠØ¸ Ù…Ø­Ù…Ø¯ Ø±Ø§ÙØ§Ù„Ù„Ù‡", p:"0927918676", v:120},
    {n:"Ù…Ø­Ù…ÙˆØ¯ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"0915516934", v:120},
    {n:"Ù…Ø­Ù…Ø¯ ÙØ±Ø¬ Ø¹Ø¨Ø¯Ø§Ù„ØºÙ†ÙŠ", p:"", v:120},
    {n:"Ø¬Ù…Ø¹Ù‡ Ø¨ÙˆØ­ÙˆÙŠÙ‡ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"", v:120},
    {n:"Ø­Ø³ÙŠÙ† ØµÙ„Ø§Ø­ Ø¬Ø¨Ø±ÙŠÙ„", p:"", v:120},
    {n:"Ø²Ø§ÙŠØ¯ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"", v:120},
    {n:"Ø³Ø¹Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ø·ÙŠ Ø§Ù„Ù…Ù‚Ø·ÙˆØ´", p:"", v:120},
    {n:"ØµÙ„Ø§Ø­ Ø¬Ø¨Ø±ÙŠÙ„ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"", v:120},
    {n:"Ø¹Ø§Ø´ÙˆØ± ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"", v:120},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ø³Ù„Ø§Ù… ÙØ±Ø¬ Ø¹Ø¨Ø¯Ø§Ù„ØºÙ†ÙŠ", p:"", v:120},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"", v:120},
    {n:"ÙØªØ§Ø­ Ø³Ø§Ù„Ù… Ø¬Ø¨Ø±ÙŠÙ„", p:"", v:120},
    {n:"ÙƒØ±ÙŠÙ… Ø³Ø§Ù„Ù… Ø¬Ø¨Ø±ÙŠÙ„", p:"", v:120},
    {n:"Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø§Ø²Ù‚ Ø§Ù„Ù†Ø§Ø¬ÙŠ", p:"", v:120},
    {n:"Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¹Ø·ÙŠÙ‡", p:"", v:120},
    {n:"ÙØ±Ø¬ Ø§Ù„Ù†Ø§Ø¬ÙŠ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"", v:0},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø§Ù„Ù†Ø§Ø¬ÙŠ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"", v:0},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„ØºÙ†ÙŠ Ø§Ù„Ù†Ø§Ø¬ÙŠ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"", v:0},
    {n:"Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ† Ø§Ù„Ù†Ø§Ø¬ÙŠ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"", v:0},
    {n:"Ø¬Ø¹ÙØ± Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ† Ø§Ù„Ù†Ø§Ø¬ÙŠ", p:"", v:0},
    {n:"Ø§Ø³Ù„Ø§Ù… Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ† Ø§Ù„Ù†Ø§Ø¬ÙŠ", p:"", v:0},
    {n:"Ø§Ù„Ù†Ø§Ø¬ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø§Ù„Ù†Ø§Ø¬ÙŠ", p:"", v:0},
    {n:"Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø§Ù„Ù†Ø§Ø¬ÙŠ", p:"", v:0},
    {n:"Ù…Ø¬Ø¯ÙŠ Ø¹ÙˆØ¶ Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ", p:"", v:0},
    {n:"Ø­Ù…Ø¯ÙŠ Ø¹ÙˆØ¶ Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ", p:"", v:0},
    {n:"Ø¹ÙŠØ³Ù‰ Ø¹ÙˆØ¶ Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ", p:"0927111502", v:0},
    {n:"Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ Ø¹ÙˆØ¶ Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ", p:"0931912893", v:0},
    {n:"Ø­Ù…Ø²Ù‡ Ø¹ÙˆØ¶ Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ", p:"0927157604", v:0},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ù‚Ø§Ø¯Ø± Ø¹ÙˆØ¶ Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ", p:"0919458058", v:0},
    {n:"Ø¹ÙˆØ¶ Ø§Ù„ÙÙŠØªÙˆØ±ÙŠ Ø¹Ø·ÙŠØ©", p:"", v:0},
    {n:"Ù…Ø­Ù…Ø¯ ØµØ§Ù„Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"0925489878", v:0},
    {n:"ÙˆÙ„ÙŠØ¯ ØµØ§Ù„Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"", v:0},
    {n:"ÙŠÙˆØ³Ù ØµØ§Ù„Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"", v:0},
    {n:"Ø§Ø³Ù„ÙŠÙ…Ø§Ù† Ø¨ÙˆØ­ÙˆÙŠÙ‡ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"0920491861", v:0},
    {n:"Ù…ÙØªØ§Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"", v:0},
    {n:"Ø¹Ù„ÙŠ Ø¨ÙˆØ­ÙˆÙŠÙ‡ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†", p:"", v:0},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ù…ÙØªØ§Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"0924610989", v:0},
    {n:"Ù†Ø§ØµØ± Ù…ÙØªØ§Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"0925802213", v:0},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø¤ÙˆÙ Ù…ÙØªØ§Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"0945509112", v:0},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø¸ÙŠÙ… Ù…ÙØªØ§Ø­ Ø¨ÙˆØ­ÙˆÙŠÙ‡", p:"0920012047", v:0},
    {n:"Ù…Ø­Ù…Ø¯ Ø­Ø³Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"", v:0},
    {n:"Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø­Ø³Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"0924849210", v:0},
    {n:"Ø¹Ø«Ù…Ø§Ù† Ø­Ø³Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ", p:"", v:0},
    {n:"Ø­Ø³Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¹Ø·ÙŠØ©", p:"", v:0},
    {n:"Ø­Ø§ÙØ¸ ØµØ§Ù„Ø­ Ø±Ø§Ù Ø§Ù„Ù„Ù‡", p:"", v:0},
    {n:"Ø±Ø§Ù Ø§Ù„Ù„Ù‡ ØµØ§Ù„Ø­ Ø±Ø§Ù Ø§Ù„Ù„Ù‡", p:"", v:0},
    {n:"Ø±Ø§ÙØ¹ Ù…Ù‚Ø·ÙˆØ´ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"0926890239", v:0},
    {n:"Ù…Ø­Ù…Ø¯ Ø±Ø§ÙØ¹ Ù…Ù‚Ø·ÙˆØ´", p:"0921194219", v:0},
    {n:"Ù…Ø¹ØªØ² Ø±Ø§ÙØ¹ Ù…Ù‚Ø·ÙˆØ´", p:"0921244439", v:0},
    {n:"Ø³Ø¹ÙŠØ¯ Ø±Ø§ÙØ¹ Ù…Ù‚Ø·ÙˆØ´", p:"0944221079", v:0},
    {n:"ÙŠØ§Ø³ÙŠÙ† Ù…Ù‚Ø·ÙˆØ´ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"", v:0},
    {n:"Ù…Ø­Ù…Ø¯ ÙŠØ§Ø³ÙŠÙ† Ù…Ù‚Ø·ÙˆØ´", p:"0927475272", v:0},
    {n:"Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ø·ÙŠ Ù…Ù‚Ø·ÙˆØ´", p:"", v:0},
    {n:"Ø¬Ø§Ø¨ Ø§Ù„Ù„Ù‡ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"0923557402", v:0},
    {n:"Ø¹Ø¨Ø¯Ø§Ù„ØºÙ†ÙŠ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"0926232796", v:0},
    {n:"Ø®Ù„ÙŠÙÙ‡ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"", v:0},
    {n:"Ø³Ù„Ø§Ù…Ù‡ ÙØ±Ø¬ Ø§Ù…Ø±Ø§Ø¬Ø¹", p:"", v:0}
];

function updateGlobalStats() {
    const totalPaidCount = members.filter(m => (m.v - requiredAmount) >= 0).length;
    const totalSum = members.reduce((sum, m) => sum + m.v, 0);
    const totalDebt = members.reduce((sum, m) => {
        let d = m.v - requiredAmount;
        return d < 0 ? sum + Math.abs(d) : sum;
    }, 0);
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ®
    const today = new Date().toLocaleDateString('ar-LY', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
    document.getElementById('currentDateDisplay').innerText = "ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: " + today;

    document.getElementById('paidCount').innerText = totalPaidCount;
    document.getElementById('unpaidCount').innerText = members.length - totalPaidCount;
    document.getElementById('totalBalanceDisplay').innerText = totalSum + " Ø¯.Ù„";
    document.getElementById('totalDebtDisplay').innerText = totalDebt + " Ø¯.Ù„";
}

function createMemberCard(m) {
    const diff = m.v - requiredAmount;
    const isPaid = diff >= 0;
    const mtebqy = isPaid ? 0 : Math.abs(diff);

    const msg = `Ø§Ù„Ø£Ø® ${m.n}.. ØªØ­ÙŠØ© Ù…Ù† Ø¬Ù…Ø¹ÙŠØ© Ø¹ÙŠØª Ø¨ÙˆØ¹ÙˆØ¬Ù‡:
- Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³Ø¯Ø¯Ø© Ù„Ø¹Ø§Ù… 2025: ${m.v} Ø¯.Ù„
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${mtebqy} Ø¯.Ù„
- Ø§Ù„Ø­Ø§Ù„Ø©: ${isPaid ? 'Ø¹Ø§Ù… Ù…Ø³Ø¯Ø¯ Ù„Ø¹Ø§Ù… 2025 âœ…' : 'ÙŠØ±Ø¬Ù‰ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ø¹Ø§Ù… 2025 âŒ'}`;

    const waLink = `https://wa.me/218${m.p ? m.p.substring(1) : ''}?text=${encodeURIComponent(msg)}`;
    const smsLink = `sms:${m.p}?body=${encodeURIComponent(msg)}`;

    return `
        <div class="member-card">
            <div class="member-name">${m.n} ${isPaid ? 'âœ…' : 'âŒ'}</div>
            <div style="font-size:14px;">
                Ø§Ù„Ù…Ø³Ø¯Ø¯ Ù„Ø¹Ø§Ù… 2025: ${m.v} Ø¯.Ù„ | 
                Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <span style="color:${isPaid ? 'green':'red'}; font-weight:bold">${mtebqy} Ø¯.Ù„</span>
                ${m.note ? `<br><small style="color:blue">(${m.note})</small>` : ''}
            </div>
            <div class="service-btns">
                <a href="${waLink}" target="_blank" class="service-btn wa" ${!m.p ? 'style="opacity:0.3; pointer-events:none;"':''}>ÙˆØ§ØªØ³Ø§Ø¨</a>
                <a href="${smsLink}" class="service-btn sms" ${!m.p ? 'style="opacity:0.3; pointer-events:none;"':''}>SMS</a>
            </div>
        </div>`;
}

function handleSearch() {
    const term = document.getElementById('searchInput').value.trim();
    const output = document.getElementById('output');
    output.innerHTML = "";
    if (term.length < 3) return;
    members.filter(m => m.n.includes(term)).forEach(r => output.innerHTML += createMemberCard(r));
}

function showAll() {
    const output = document.getElementById('output');
    output.innerHTML = "";
    members.forEach(m => output.innerHTML += createMemberCard(m));
}

function toggleStats() {
    const area = document.getElementById('statsArea');
    area.style.display = area.style.display === "none" ? "grid" : "none";
}

function copyFullReport() {
    const today = new Date().toLocaleDateString('ar-LY');
    const report = `ğŸ“Š *ØªÙ‚Ø±ÙŠØ± Ø¬Ù…Ø¹ÙŠØ© Ø¹ÙŠØª Ø¨ÙˆØ¹ÙˆØ¬Ù‡ - 2025*
-----------------------------
ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${today}
ğŸ‘¥ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: 86
âœ… Ø§Ù„Ù…Ø³Ø¯Ø¯ÙŠÙ†: ${document.getElementById('paidCount').innerText}
âŒ ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¯Ø¯ÙŠÙ†: ${document.getElementById('unpaidCount').innerText}
âš ï¸ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${document.getElementById('totalDebtDisplay').innerText}
ğŸ’° Ø±ØµÙŠØ¯ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚: ${document.getElementById('totalBalanceDisplay').innerText}
-----------------------------
Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø·ÙˆØ±: Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¹Ø·ÙŠØ©`;

    navigator.clipboard.writeText(report).then(() => alert("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ØªÙ‚Ø±ÙŠØ±!"));
}

function exportToExcel() {
    const data = members.map(m => ({
        "Ø§Ù„Ø§Ø³Ù…": m.n,
        "Ø§Ù„Ù…Ø³Ø¯Ø¯ Ù„Ø¹Ø§Ù… 2025": m.v,
        "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ": m.v - requiredAmount >= 0 ? 0 : Math.abs(m.v - requiredAmount),
        "Ø§Ù„Ø­Ø§Ù„Ø©": (m.v - requiredAmount) >= 0 ? "Ù…Ø³Ø¯Ø¯ âœ…" : "ØºÙŠØ± Ù…Ø³Ø¯Ø¯ âŒ"
    }));
    const worksheet = XLSX.utils.json_to_sheet(data);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, "ÙƒØ´Ù 2025");
    XLSX.writeFile(workbook, "ÙƒØ´Ù_Ø¹ÙŠØª_Ø¨ÙˆØ¹ÙˆØ¬Ù‡_2025.xlsx");
}

updateGlobalStats();
</script>
</body>
</html>
